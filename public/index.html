<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Socket.io</title>
</head>
<body>
  <h1>Communicating with socket .io!</h1>
  <p><input id="poke"
         type="button"
         value="Poke the server"></p>
  <div id="output">
    output
  </div>
  <div id="loading"><img alt=""
       src="https://cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif"></div>
  <script>
      console.log("Los gehts");
        let button = document.querySelector("#poke");
        let outputcontainer = document.querySelector("#output");
        let loading = document.querySelector("#loading");
        loading.style = "display:none;"
        let output = false;
        button.addEventListener("click", function(){
            console.log("loading begins");
            loading.style = "display:block;"  
          fetch('./api/scrapes')
              .then(function (response) {                
                  return response.json();
              })
              .then(function (data) {
                  console.log("loading ends");
                  output = data;
                  console.log(data);
                  let markup = `${output.map(article => `<div>${article.title}<\/div><div>${article.url}<\/div>`).join('')}`;
                  outputcontainer.innerHTML = markup;
                  loading.style = "display:none;"
              })
              .catch(function (error) {
                  console.log("loading error");
                  loading.style = "display:none;"
                  console.error(error);
              });
          
      });
      
  </script>
</body>
</html>
